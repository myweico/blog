<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>JavaScirpt判断数据类型方法总结</title>
    <url>/blog/2020/12/26/JavaScirpt%E5%88%A4%E6%96%AD%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<p>JavaScript经常需要用到数据类型判断，以下是我总结的几种方法。</p>
<a id="more"></a>

<h2 id="方法一：typeof"><a href="#方法一：typeof" class="headerlink" title="方法一：typeof"></a>方法一：typeof</h2><p>typeof 是 JavaScript 中最简单的获取数据类型的方法。</p>
<p>缺点：</p>
<ul>
<li>不能区分数组、正则表达式、日期对象等引用类型的数据，引用类型全为 <code>object</code>(函数除外)</li>
</ul>
<p>示例：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'string'</span>;</span><br><span class="line"><span class="keyword">var</span> number = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">var</span> boolean = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">var</span> nullValue = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">var</span> undefinedValue = <span class="literal">undefined</span>;</span><br><span class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> func = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'hello'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/.*/</span>;</span><br><span class="line"><span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'typeof string: '</span>, <span class="keyword">typeof</span> str);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'typeof number: '</span>, <span class="keyword">typeof</span> number);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'typeof boolean: '</span>, <span class="keyword">typeof</span> boolean);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'typeof nullValue: '</span>, <span class="keyword">typeof</span> nullValue);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'typeof undefinedValue: '</span>, <span class="keyword">typeof</span> undefinedValue);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'typeof function: '</span>, <span class="keyword">typeof</span> func);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'typeof obj: '</span>, <span class="keyword">typeof</span> obj);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'typeof reg: '</span>, <span class="keyword">typeof</span> reg);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'typeof date: '</span>, <span class="keyword">typeof</span> date);</span><br></pre></td></tr></table></figure>
<p>运行结果:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="string">"typeof string: "</span> <span class="string">"string"</span></span><br><span class="line"><span class="string">"typeof number: "</span> <span class="string">"number"</span></span><br><span class="line"><span class="string">"typeof boolean: "</span> <span class="string">"boolean"</span></span><br><span class="line"><span class="string">"typeof nullValue: "</span> <span class="string">"object"</span></span><br><span class="line"><span class="string">"typeof undefinedValue: "</span> <span class="string">"undefined"</span></span><br><span class="line"><span class="string">"typeof function: "</span> <span class="string">"function"</span></span><br><span class="line"><span class="string">"typeof obj: "</span> <span class="string">"object"</span></span><br><span class="line"><span class="string">"typeof reg: "</span> <span class="string">"object"</span></span><br><span class="line"><span class="string">"typeof date: "</span> <span class="string">"object"</span></span><br></pre></td></tr></table></figure>

<h2 id="方法二：instanceof"><a href="#方法二：instanceof" class="headerlink" title="方法二：instanceof"></a>方法二：instanceof</h2><p>缺点：</p>
<ul>
<li>这个方法只能判断引用数据类型</li>
<li>只能判断是否某个具体的类型，而不能直接获取对应的数据类型</li>
</ul>
<p>示例:</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'string'</span>;</span><br><span class="line"><span class="keyword">var</span> number = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">var</span> boolean = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">var</span> nullValue = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">var</span> undefinedValue = <span class="literal">undefined</span>;</span><br><span class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> func = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'hello'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/.*/</span>;</span><br><span class="line"><span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'func instanceof Function: '</span>, func <span class="keyword">instanceof</span> <span class="built_in">Function</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'reg instanceof RegExp: '</span>, reg <span class="keyword">instanceof</span> <span class="built_in">RegExp</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'date instanceof Date: '</span>, date <span class="keyword">instanceof</span> <span class="built_in">Date</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'arr instanceof Array'</span>, array <span class="keyword">instanceof</span> <span class="built_in">Array</span>);</span><br></pre></td></tr></table></figure>
<p>运行结果:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><span class="line"><span class="string">"func instanceof Function: "</span> <span class="literal">true</span></span><br><span class="line"><span class="string">"reg instanceof RegExp: "</span> <span class="literal">true</span></span><br><span class="line"><span class="string">"date instanceof Date: "</span> <span class="literal">true</span></span><br><span class="line"><span class="string">"arr instanceof Array"</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h2 id="方法三：-使用constructor"><a href="#方法三：-使用constructor" class="headerlink" title="方法三： 使用constructor"></a>方法三： 使用constructor</h2><p>缺点：</p>
<ul>
<li>开发者一旦重写 <code>prototype</code>，就容易使得数据的 <code>constructor</code> 丢失</li>
<li>与 <code>instanceof</code> 相同，只能判断数据是否某个具体的数据类型，而不能直接获取数据的数据类型</li>
</ul>
<p>示例：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'string'</span>;</span><br><span class="line"><span class="keyword">var</span> number = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">var</span> boolean = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">var</span> nullValue = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">var</span> undefinedValue = <span class="literal">undefined</span>;</span><br><span class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> func = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'hello'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/.*/</span>;</span><br><span class="line"><span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第三种方式 查看constructor</span></span><br><span class="line"><span class="comment">// 确定 null、undefined 没有 constructor且开发者重写prototype后，原有的constructor可能会丢失</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'str.countructor === String: '</span>, str.constructor === <span class="built_in">String</span>);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"number.constructor === Number: "</span>, number.constructor === <span class="built_in">Number</span>)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"boolean.constructor === Boolean: "</span>, boolean.constructor === <span class="built_in">Boolean</span>);</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<h2 id="方法四：最准确的方法-使用-Object-prototype-toString"><a href="#方法四：最准确的方法-使用-Object-prototype-toString" class="headerlink" title="方法四：最准确的方法 - 使用 Object.prototype.toString()"></a>方法四：最准确的方法 - 使用 Object.prototype.toString()</h2><p>封装的函数：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 第四种方式，最准确的方式,使用Object.prototype.toString</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toString</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> typeString = <span class="built_in">Object</span>.prototype.toString.apply(value);</span><br><span class="line">  <span class="keyword">return</span> typeString.slice(<span class="number">8</span>, <span class="number">-1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>示例：</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">'string'</span>;</span><br><span class="line"><span class="keyword">var</span> number = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">var</span> boolean = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">var</span> nullValue = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">var</span> undefinedValue = <span class="literal">undefined</span>;</span><br><span class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> func = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'hello'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> array = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">var</span> reg = <span class="regexp">/.*/</span>;</span><br><span class="line"><span class="keyword">var</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第四种方式，最准确的方式,使用Object.prototype.toString</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toString</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> typeString = <span class="built_in">Object</span>.prototype.toString.apply(value);</span><br><span class="line">  <span class="keyword">return</span> typeString.slice(<span class="number">8</span>, <span class="number">-1</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'toString string: '</span>, toString(str));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'toString number: '</span>, toString(number));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'toString boolean: '</span>, toString(boolean));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'toString nullValue: '</span>, toString(nullValue));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'toString undefinedValue: '</span>, toString(undefinedValue));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'toString function: '</span>, toString(func));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'toString obj: '</span>, toString(obj));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'toString reg: '</span>, toString(reg));</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'toString date: '</span>, toString(date));</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&quot;toString string: &quot; &quot;String&quot;</span><br><span class="line">&quot;toString number: &quot; &quot;Number&quot;</span><br><span class="line">&quot;toString boolean: &quot; &quot;Boolean&quot;</span><br><span class="line">&quot;toString nullValue: &quot; &quot;Null&quot;</span><br><span class="line">&quot;toString undefinedValue: &quot; &quot;Undefined&quot;</span><br><span class="line">&quot;toString function: &quot; &quot;Function&quot;</span><br><span class="line">&quot;toString obj: &quot; &quot;Object&quot;</span><br><span class="line">&quot;toString reg: &quot; &quot;RegExp&quot;</span><br><span class="line">&quot;toString date: &quot; &quot;Date&quot;</span><br></pre></td></tr></table></figure>

<h2 id="方法五：使用JS自带的函数判断"><a href="#方法五：使用JS自带的函数判断" class="headerlink" title="方法五：使用JS自带的函数判断"></a>方法五：使用JS自带的函数判断</h2><p>例如：<code>Array.isArray()</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Array.isArray([]);</span><br></pre></td></tr></table></figure>
<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">true</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>JavaScript</category>
      </categories>
      <tags>
        <tag>JavaScirpt</tag>
      </tags>
  </entry>
  <entry>
    <title>调试神器-Charles抓包工具的使用</title>
    <url>/blog/2020/11/14/charles-notes/</url>
    <content><![CDATA[<h2 id="Charles"><a href="#Charles" class="headerlink" title="Charles"></a>Charles</h2><p>Charles 是一个抓包软件，能够抓取电脑以及手机上的 http/https 的网络包，对于我们调试接口来说，十分方便。</p>
<p>Charles 提供的功能：</p>
<ul>
<li>抓包</li>
<li>修改请求，再次发送</li>
<li>并发、重复发起请求，压力测试</li>
<li>限流，调试弱网情况</li>
<li>修改请求、以及响应</li>
</ul>
<a id="more"></a>

<p>charles 的原理是，启动一个代理服务器，让请求包都经过 charles 启动的代理服务器，然后再请求对应的 url。</p>
<h2 id="抓包"><a href="#抓包" class="headerlink" title="抓包"></a>抓包</h2><h3 id="启动-charles-的-http-代理服务"><a href="#启动-charles-的-http-代理服务" class="headerlink" title="启动 charles 的 http 代理服务"></a>启动 charles 的 http 代理服务</h3><ol>
<li><p>charles 菜单栏 <code>proxy</code> - <code>proxy-setting</code><br><img src="https://blog-1257268092.cos.ap-guangzhou.myqcloud.com/notes/20201114184335.png" alt=""></p>
</li>
<li><p>启动 charles 的代理服务器，并设置端口（此处设置为 9999）<br><img src="https://blog-1257268092.cos.ap-guangzhou.myqcloud.com/notes/20201114184517.png" alt=""></p>
</li>
</ol>
<h3 id="Mac-上的代理"><a href="#Mac-上的代理" class="headerlink" title="Mac 上的代理"></a>Mac 上的代理</h3><ol>
<li>菜单栏上 <code>proxy</code> - <code>Mac Proxy</code> ，启动 Mac 上的代理</li>
</ol>
<p>这时候 Mac 上的 http 请求已经可以正常抓取到了，但是 https 还是一堆乱码甚至无法访问，因为没有还没有安装 charles 的安全证书</p>
<ol start="2">
<li>安装 charles 的安装证书，点击 charles 菜单栏 - <code>help</code> - <code>SSL Proxying</code> - <code>Install Charles Root Certificate</code><br><img src="https://blog-1257268092.cos.ap-guangzhou.myqcloud.com/notes/20201114185032.png" alt=""></li>
</ol>
<p>安装证书<br><img src="https://blog-1257268092.cos.ap-guangzhou.myqcloud.com/notes/20201114185250.png" alt=""></p>
<p>在钥匙串里面搜索到 charles 的证书 - 双击 - 在 trust 下面 设置为 <code>always trust</code><br><img src="https://blog-1257268092.cos.ap-guangzhou.myqcloud.com/notes/20201114185718.png" alt=""></p>
<ol start="3">
<li>这时候 Mac 上的 http 以及 https 的网络包都可以正常抓取了</li>
</ol>
<h3 id="ios-上的代理（安卓同理）"><a href="#ios-上的代理（安卓同理）" class="headerlink" title="ios 上的代理（安卓同理）"></a>ios 上的代理（安卓同理）</h3><ol>
<li>手机连上 Mac 同局域网下的 wifi，将 wifi 的代理设置为 charles 的代理服务即可</li>
</ol>
<p><code>wifi</code> - 点击与 Mac 同样的 wifi - 滚动到最后，<code>配置代理</code> - 设置为手动 - 代理服务器写 Mac 的 ip 地址（charles 菜单栏 - help - Local IP Address 可以获取） - 端口写 charles 的代理端口（这里是 9999）<br><img src="https://blog-1257268092.cos.ap-guangzhou.myqcloud.com/notes/20201114190842.png" style="height:600px; margin: 0 auto;" /></p>
<ol start="2">
<li><p>手机上安装证书，charles 菜单栏 <code>help</code> - <code>SSL Proxying</code> - 选择在手机上安装证书`</p>
<img src="https://blog-1257268092.cos.ap-guangzhou.myqcloud.com/notes/20201114190934.png" style="margin: 0 auto;" />
</li>
<li><p>手机浏览器访问对话框指定的 url，下载证书（这里是<code>chls.pro/ssl</code>)</p>
<img src="https://blog-1257268092.cos.ap-guangzhou.myqcloud.com/notes/20201114191023.png" style="margin: 0 auto;" />
</li>
<li><p>下载完成后，打开手机设置 - <code>通用</code> - 滑到最后，选择<code>描述文件</code> - 安装刚下载的证书</p>
</li>
<li><p>然后回到 <code>通用</code> - 滑到最前，选择<code>关于本机</code> - 然后滑到最后，选择<code>证书信任设置</code> - 选择信任刚刚安装好的证书</p>
</li>
<li><p>这时候手机上 http 以及 https 的网络包已经可以正常抓取了（调试完毕后记得关掉代理，否则会无法上网，为了安全，可将证书暂时设置为不信任，调试的时候再信任即可）</p>
</li>
</ol>
<h2 id="筛选"><a href="#筛选" class="headerlink" title="筛选"></a>筛选</h2><p>网络请求过多，不易找到我们想要监听的网络包，可以使用一下方法：</p>
<ul>
<li>搜索：<code>edit</code> - <code>find</code> 或者 <code>Command + F</code>快捷键筛选</li>
<li>设置 filter</li>
<li>将要监听的 url 设置为 focus</li>
<li>设置监听选项：<code>Proxy</code> - <code>Recording Settings</code>里面配置 include 或者 exclude</li>
</ul>
<h2 id="限流"><a href="#限流" class="headerlink" title="限流"></a>限流</h2><p>在 <code>Proxy</code> -  Throttle` 可以限流，模拟各种网络请求速度，这对于我们模拟弱网条件十分有用</p>
<h2 id="编辑请求，重新发送请求"><a href="#编辑请求，重新发送请求" class="headerlink" title="编辑请求，重新发送请求"></a>编辑请求，重新发送请求</h2><ul>
<li>compose：编辑请求的内容，再次发送请求，这在测试接口的时候就非常有用</li>
<li>repeat：再次发送请求</li>
<li>repeat advance: 可以设置请求次数，并发数，可用于压测</li>
</ul>
<h2 id="修改响应"><a href="#修改响应" class="headerlink" title="修改响应"></a>修改响应</h2><ul>
<li>Map Remote: 将指定url映射到指定url，在调试微信支付域名校验的时候十分有用，可以将正式服的域名映射到测试服中，调试测试服</li>
<li>Map Local: 将响应映射到本地文件</li>
<li>Map Rewrite: 将匹配到的内容重写为指定内容，（可正则匹配）</li>
<li>BreakPoint: 设置请求的断点，可单个调试请求，修改请求和响应</li>
</ul>
]]></content>
      <tags>
        <tag>测试</tag>
        <tag>运维</tag>
      </tags>
  </entry>
  <entry>
    <title>flutter尝鲜：flutter的安装</title>
    <url>/blog/2020/12/15/flutter-install/</url>
    <content><![CDATA[<h2 id="Mac端"><a href="#Mac端" class="headerlink" title="Mac端"></a>Mac端</h2><ol>
<li><p>下载 Flutter SDK，在<a href="https://flutter.cn/docs/get-started/install" target="_blank" rel="noopener">flutter.cn</a>下载的速度会快很多</p>
</li>
<li><p>下载好后，解压到文件夹内</p>
</li>
</ol>
<a id="more"></a>

<ol start="3">
<li>由于在国内访问flutter可能会受到限制，Flutter官方为中国开发者搭建了临时镜像，将如下环境变量加入到用户环境变量中即可：<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">export PUB_HOSTED_URL&#x3D;https:&#x2F;&#x2F;pub.flutter-io.cn</span><br><span class="line">export FLUTTER_STORAGE_BASE_URL&#x3D;https:&#x2F;&#x2F;storage.flutter-io.cn</span><br></pre></td></tr></table></figure>
同时，需要将flutter的命令也添加到命令行中<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">export PATH&#x3D;$&#123;这里替换为Flutter的解压目录&#125;&#x2F;flutter&#x2F;bin:$PATH</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="IOS设置"><a href="#IOS设置" class="headerlink" title="IOS设置"></a>IOS设置</h2><h3 id="配置模拟器"><a href="#配置模拟器" class="headerlink" title="配置模拟器"></a>配置模拟器</h3><p>使用以下命令打开模拟器</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">open -a Simulator</span><br></pre></td></tr></table></figure>

<h3 id="安装到真机"><a href="#安装到真机" class="headerlink" title="安装到真机"></a>安装到真机</h3><ol>
<li>安装<a href="http://brew.sh/" target="_blank" rel="noopener">homebrew</a></li>
<li>使用homebrew安装以下工具<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">brew update</span><br><span class="line">brew install --HEAD libimobiledevice</span><br><span class="line">brew install ideviceinstaller ios-deploy cocoapods</span><br><span class="line">pod setup</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="安卓配置"><a href="#安卓配置" class="headerlink" title="安卓配置"></a>安卓配置</h2><h3 id="模拟器"><a href="#模拟器" class="headerlink" title="模拟器"></a>模拟器</h3><p>Android Studio 安装好模拟器后，可以使用以下命令启动模拟器(<code>Nexus_5_API_22</code>为模拟器的名字)<br>先设置zsh里面的emulator别名</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">alias emulator&#x3D;&quot;&#x2F;Users&#x2F;wmy&#x2F;Library&#x2F;Android&#x2F;sdk&#x2F;emulator&#x2F;emulator&quot;</span><br></pre></td></tr></table></figure>
<p>然后启动模拟器</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">emulator -avd Nexus_5_API_22</span><br></pre></td></tr></table></figure>]]></content>
      <tags>
        <tag>flutter</tag>
        <tag>移动端</tag>
      </tags>
  </entry>
  <entry>
    <title>解决 github 图片显示不了的问题</title>
    <url>/blog/2020/02/21/github-picture-display/</url>
    <content><![CDATA[<img src="/blog/images/github-pic-display.png" class="" width="600" title="title text" alt="alt text">

<p>有时候发现，国内的 github 的图片显示不了，这就让人很苦恼。</p>
<p>其实是存放图片的<code>avatars0.githubusercontent.com</code>等相关网址被墙了原因。</p>
<p>只需要修改 host 文件的相关内容即可以让 github 正常显示图片。</p>
<a id="more"></a>
<h2 id="host-文件位置"><a href="#host-文件位置" class="headerlink" title="host 文件位置"></a>host 文件位置</h2><ul>
<li>Mac OS: <code>/etc/hosts</code></li>
<li>Windows: <code>C:\system32\drivers\etc\hosts</code></li>
</ul>
<h2 id="host-文件添加内容"><a href="#host-文件添加内容" class="headerlink" title="host 文件添加内容"></a>host 文件添加内容</h2><p>寻找到 host 文件，在里面添加以下内容</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># github start</span><br><span class="line">192.30.253.112    github.com</span><br><span class="line">192.30.253.119    gist.github.com</span><br><span class="line">199.232.28.133    assets-cdn.github.com</span><br><span class="line">199.232.28.133    raw.githubusercontent.com</span><br><span class="line">199.232.28.133    gist.githubusercontent.com</span><br><span class="line">199.232.28.133    cloud.githubusercontent.com</span><br><span class="line">199.232.28.133    camo.githubusercontent.com</span><br><span class="line">199.232.28.133    avatars0.githubusercontent.com</span><br><span class="line">199.232.28.133    avatars1.githubusercontent.com</span><br><span class="line">199.232.28.133    avatars2.githubusercontent.com</span><br><span class="line">199.232.28.133    avatars3.githubusercontent.com</span><br><span class="line">199.232.28.133    avatars4.githubusercontent.com</span><br><span class="line">199.232.28.133    avatars5.githubusercontent.com</span><br><span class="line">199.232.28.133    avatars6.githubusercontent.com</span><br><span class="line">199.232.28.133    avatars7.githubusercontent.com</span><br><span class="line">199.232.28.133    avatars8.githubusercontent.com</span><br><span class="line"># github end</span><br></pre></td></tr></table></figure>
<p>然后尝试刷新浏览器，便可以看到 github 可以正常显示图片了</p>
<img src="https://blog-1257268092.cos.ap-guangzhou.myqcloud.com/notes/20200221070415.png" class="" width="600" title="title text" alt="alt text">

<p>若不行，再尝试刷新 DNS 缓存。</p>
]]></content>
      <categories>
        <category>技巧</category>
      </categories>
      <tags>
        <tag>github</tag>
      </tags>
  </entry>
  <entry>
    <title>常用的JavaScript算法</title>
    <url>/blog/2020/12/23/%E5%B8%B8%E7%94%A8%E7%9A%84JavaScript%E7%AE%97%E6%B3%95/</url>
    <content><![CDATA[<p>常用的 JavaScript 方法。</p>
<a id="more"></a>

<h2 id="Dom-相关"><a href="#Dom-相关" class="headerlink" title="Dom 相关"></a>Dom 相关</h2><h3 id="事件代理"><a href="#事件代理" class="headerlink" title="事件代理"></a>事件代理</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.getElementById(<span class="string">"father-id"</span>).onClick = <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">  event = event || <span class="built_in">window</span>.event;</span><br><span class="line">  <span class="keyword">const</span> target = event.target || event.srcElement;</span><br><span class="line">  <span class="keyword">if</span> (target.nodeName.toLowerCase() === <span class="string">'xxx'</span>) &#123;</span><br><span class="line">    <span class="comment">// event handler</span></span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="数组相关"><a href="#数组相关" class="headerlink" title="数组相关"></a>数组相关</h2><h3 id="数组扁平化"><a href="#数组扁平化" class="headerlink" title="数组扁平化"></a>数组扁平化</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">flatten</span>(<span class="params">arr</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (!<span class="built_in">Array</span>.isArray(arr)) <span class="keyword">return</span> [];</span><br><span class="line">  <span class="keyword">let</span> _array = [];</span><br><span class="line">  arr.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">elem</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(elem)) &#123;</span><br><span class="line">      _array = _array.concat(flatten(elem));</span><br><span class="line">      <span class="comment">// arr = [...arr, ...flatten(elem)]</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// 不是数组元素</span></span><br><span class="line">      _array.push(elem);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> _array;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> array = [<span class="number">1</span>, [<span class="number">2</span>], [[<span class="number">3</span>]], [[[<span class="number">4</span>]]]];</span><br><span class="line"><span class="keyword">const</span> arrayFlatten= flatten(array);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'array before flatten'</span>, array);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'array after flatten'</span>, arrayFlatten);</span><br></pre></td></tr></table></figure>

<p>运行结果:</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">array before flatten (4) [1, Array(1), Array(1), Array(1)]</span><br><span class="line">array after flatten: [1, 2, 3, 4]</span><br></pre></td></tr></table></figure>

<h2 id="去重"><a href="#去重" class="headerlink" title="去重"></a>去重</h2><p>方法 1</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">set</span> = new Set();</span><br><span class="line">  const arrayUnique = [];</span><br><span class="line">  array.forEach(function (elem) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">set</span>.has(elem)) return;</span><br><span class="line"></span><br><span class="line">    // 元素不存在，添加到数组中</span><br><span class="line">    arrayUnique.push(elem);</span><br><span class="line">    <span class="keyword">set</span>.add(elem);</span><br><span class="line">  &#125;)</span><br><span class="line">  return arrayUnique;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(unique([1,2,2,2,3,4,5]))</span><br></pre></td></tr></table></figure>

<p>方法 2</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">unique</span>(<span class="params">array</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [...new <span class="built_in">Set</span>(array)];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(unique([<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]));</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[ 1, 2, 3, 4, 5 ]</span><br></pre></td></tr></table></figure>

<h2 id="拷贝"><a href="#拷贝" class="headerlink" title="拷贝"></a>拷贝</h2><h3 id="浅拷贝"><a href="#浅拷贝" class="headerlink" title="浅拷贝"></a>浅拷贝</h3><p>方法 1</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">copy</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> result = <span class="built_in">Array</span>.isArray(obj) ? [] : &#123;&#125;;</span><br><span class="line">  <span class="comment">// 处理了键名为 Symbol 的情况</span></span><br><span class="line">  [...Object.keys(obj), ...Object.getOwnPropertySymbols(obj)].foreach(<span class="function"><span class="params">key</span> =&gt;</span> &#123;</span><br><span class="line">    result[key] = obj[key]</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>方法 2</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">copy</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Array</span>.isArray(obj) ? [...obj] : &#123; ...obj &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>方法 3</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">copy</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Object</span>.assign(<span class="built_in">Array</span>.isArray(obj) ? [] : &#123;&#125;, obj);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="深拷贝"><a href="#深拷贝" class="headerlink" title="深拷贝"></a>深拷贝</h2><p>方法 1，使用 <code>JSON.stringify(JSON.parse(obj))</code><br>缺点：</p>
<ul>
<li>遇到 <code>undefined</code>, <code>NaN</code>, <code>-Infinity</code>, <code>Infinity</code>， <code>function</code>，<code>RegExp</code> 会默认转为 <code>null</code>,</li>
<li>遇到函数会报错</li>
<li><code>Date</code>对象会转为字符串</li>
<li>循环引用时候回报错（a = {}, a.b = a 这种情况)</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepCopy</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上面的方法遇到函数的话，JSON 将会序列化错误，可以使用 JSON.parse 以及 JSON.stringify 的第二个参数，对函数以及其他数据类型进行处理</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleParse</span>(<span class="params">key, value</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">eval</span>(value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleStringify</span>(<span class="params">key, value</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value, <span class="keyword">typeof</span> value);</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> value === <span class="string">"function"</span>) &#123;</span><br><span class="line">    <span class="comment">// 避免 valuee = function() &#123;&#125; 时报错</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">`i = <span class="subst">$&#123;value&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (value <span class="keyword">instanceof</span> <span class="built_in">RegExp</span>) &#123;</span><br><span class="line">    <span class="comment">// 正则表达式</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;value&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    <span class="keyword">typeof</span> value === <span class="string">"string"</span> &amp;&amp;</span><br><span class="line">    /^\d&#123;<span class="number">4</span>&#125;-\d&#123;<span class="number">2</span>&#125;-\d&#123;<span class="number">2</span>&#125;T\d&#123;<span class="number">2</span>&#125;:\d&#123;<span class="number">2</span>&#125;:\d&#123;<span class="number">2</span>&#125;/.test(value)</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="comment">// 时间日期对象，JSON.stringify(会自动把日期对象转为字符串，value已经是日期字符串格式 2020-12-26T12:38:48.964Z)</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">`new Date('<span class="subst">$&#123;value&#125;</span>')`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepCopy</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj, handleStringify), handleParse);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>方法 2<br>解决了循环引用以及键名为 Symbol 的情况</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">deepCopy</span>(<span class="params">obj, cached = new Map(</span>)) </span>&#123;</span><br><span class="line">  <span class="comment">// 若为函数的话，</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> obj === <span class="string">"function"</span>) &#123;</span><br><span class="line">    <span class="comment">// // 直接返回</span></span><br><span class="line">    <span class="comment">// return obj;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 若想复制函数，可以</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">eval</span>(<span class="string">`i = <span class="subst">$&#123;obj&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 若为原始值，则直接返回</span></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> obj !== <span class="string">"object"</span>) <span class="keyword">return</span> obj;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 处理正则表达式</span></span><br><span class="line">  <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> <span class="built_in">RegExp</span>) &#123;</span><br><span class="line">    <span class="comment">// // 直接返回</span></span><br><span class="line">    <span class="comment">// return obj;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 若想复制，可以</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">eval</span>(<span class="string">`<span class="subst">$&#123;obj&#125;</span>`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 处理 Date 对象</span></span><br><span class="line">  <span class="keyword">if</span> (obj <span class="keyword">instanceof</span> <span class="built_in">Date</span>) &#123;</span><br><span class="line">    <span class="comment">// // 直接返回</span></span><br><span class="line">    <span class="comment">// return obj;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 若想复制，可以</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">eval</span>(<span class="string">`new Date(<span class="subst">$&#123;obj.getTime()&#125;</span>)`</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (cached.has(obj)) &#123;</span><br><span class="line">    <span class="comment">// 若已经出现，则直接返回</span></span><br><span class="line">    <span class="keyword">return</span> cached.get(obj);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> result = <span class="built_in">Array</span>.isArray(obj) ? [] : &#123;&#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 加入到缓存中</span></span><br><span class="line">  cached.set(obj, result);</span><br><span class="line"></span><br><span class="line">  [...Object.keys(obj), ...Object.getOwnPropertySymbols(obj)].forEach(<span class="function"><span class="keyword">function</span> (<span class="params"></span></span></span><br><span class="line"><span class="function"><span class="params">    key</span></span></span><br><span class="line"><span class="function"><span class="params">  </span>) </span>&#123;</span><br><span class="line">    result[key] = deepCopy(obj[key], cached);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><h3 id="去空格"><a href="#去空格" class="headerlink" title="去空格"></a>去空格</h3><p>方法 1，正则表达式替换</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myTrim</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> str.replace(<span class="regexp">/(^\s*)|(\s*$)/g</span>, <span class="string">""</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(myTrim(<span class="string">"    ok    "</span>).length);</span><br></pre></td></tr></table></figure>

<p>方法 2, 算出第一个不是空格的位置，以及最后一个不是空格的位置，然后截取字符对应的位置</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">myTrim</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> start = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">let</span> end = str.length - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (; start &lt; str.length; start++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (str[start] !== <span class="string">" "</span>) <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (; end &gt;= <span class="number">0</span>; end--) &#123;</span><br><span class="line">    <span class="keyword">if</span> (str[end] !== <span class="string">" "</span>) <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> str.slice(start, end + <span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(myTrim(<span class="string">"  ok   "</span>).length);</span><br></pre></td></tr></table></figure>

<p>方法 3： 字符串对象内置方法 trim()</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">"   ok  "</span>;</span><br><span class="line"><span class="built_in">console</span>.log(str.trim());</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>算法</tag>
        <tag>JavaScript</tag>
      </tags>
  </entry>
  <entry>
    <title>前端模块化-CommonJS、AMD、UMD以及ESM</title>
    <url>/blog/2020/07/05/front-end-modules-summary/</url>
    <content><![CDATA[<h2 id="什么是前端模块？"><a href="#什么是前端模块？" class="headerlink" title="什么是前端模块？"></a>什么是前端模块？</h2><p>模块是实现特定功能的部件集合，在前端中，模块则对应于实现某功能的函数、逻辑的集合。</p>
<p>通常来说，一个文件就是一个模块，有自己的作用域，可以导入其他模块以及向外暴露自己的函数和变量。</p>
<p>目前前端模块化有CommonJS、AMD、CMD和ESM这几种主要的标准，而UMD则是一种兼容 CommonJS、AMD以及CMD的一种兼容性写法。</p>
<a id="more"></a>
<h2 id="CommonJS"><a href="#CommonJS" class="headerlink" title="CommonJS"></a>CommonJS</h2><p><code>NodeJS</code> 是 <code>CommonJS</code> 规范的主要实现者。<code>CommonJS</code>主要实现如下：</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// -- todo.js</span></span><br><span class="line"><span class="keyword">var</span> todos = [];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">item</span>) </span>&#123;</span><br><span class="line">    todo.push(item);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getTodo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> todos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 通过 module.exports 导出模块</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    addTodo,</span><br><span class="line">    getTodo</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// -- index.js</span></span><br><span class="line"><span class="comment">// 通过require引入模块</span></span><br><span class="line"><span class="keyword">var</span> todo  = <span class="built_in">require</span>(<span class="string">'./todo'</span>);</span><br><span class="line"></span><br><span class="line">todo.addTodo(<span class="string">'read document'</span>);</span><br></pre></td></tr></table></figure>

<h3 id="exports-和-module-exports-的区别"><a href="#exports-和-module-exports-的区别" class="headerlink" title="exports 和 module.exports 的区别"></a>exports 和 module.exports 的区别</h3><p>exports是对module.exports的初始引用，一旦 module.exports 的引用指向发生改变，则exports 的引用将会失效</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 若module.exports 的引用没有发生改变，则exports和module.exports 同效</span></span><br><span class="line">exports = &#123;</span><br><span class="line">    addTodos,</span><br><span class="line">    getTodos</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// module.exports 的引用发生改变，则 exports 失效</span></span><br><span class="line">modules.exports = &#123;</span><br><span class="line">    addTodos,</span><br><span class="line">    getTodos</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 此时exports已失效</span></span><br><span class="line">exports.removeTodo = <span class="function"><span class="keyword">function</span>(<span class="params">index</span>) </span>&#123;</span><br><span class="line">    todos = todos.splice(index);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>CommonJS 加载模块是同步的，只有加载完成才执行后面的操作。</p>
<p>对于NodeJS，由于模块都已经是存在本地的了，所以同步加载模块比较快，不用考虑异步加载。</p>
<p>而对于浏览器来说，若模块都是从网络上同步加载，这将阻塞后面内容的渲染，使用同步加载方案的CommonJS就有点不太合适了。所以就有了 AMD、CMD 等异步加载模块的方案。</p>
<h2 id="AMD-和-requireJS"><a href="#AMD-和-requireJS" class="headerlink" title="AMD 和 requireJS"></a>AMD 和 requireJS</h2><p><a href="https://github.com/amdjs/amdjs-api/blob/master/AMD.md" target="_blank" rel="noopener">AMD</a> (即 Asynchronous Module Definitio)。<a href="https://requirejs.org/" target="_blank" rel="noopener">requireJS</a> 就是实现了 AMD 规范的一个模块加载库。</p>
<p>通过引入 requireJS，我们就不必手动通过 scirpt 标签引入各种库，<code>requireJS</code> 会帮我们处理这一切。</p>
<h3 id="引入requireJS"><a href="#引入requireJS" class="headerlink" title="引入requireJS"></a>引入requireJS</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>My Sample Project<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- data-main attribute tells require.js to load</span></span><br><span class="line"><span class="comment">             scripts/main.js after require.js loads. --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">data-main</span>=<span class="string">"scripts/main"</span> <span class="attr">src</span>=<span class="string">"scripts/require.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>My Sample Project<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>requireJS 加载完后，就会执行 <code>scripts/main</code> 的脚本，相关的引入代码可以在  main 文件中编写</p>
<h3 id="定义模块"><a href="#定义模块" class="headerlink" title="定义模块"></a>定义模块</h3><blockquote>
<p>requireJS 定义模块文档 =&gt; <a href="https://requirejs.org/docs/api.html#define" target="_blank" rel="noopener">https://requirejs.org/docs/api.html#define</a></p>
</blockquote>
<p>AMD 模块使用 <code>define</code> 函数定义模块</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">define(moduleName?: String, dependencies?: String[], factory: Function|Object);</span><br></pre></td></tr></table></figure>
<p>各参数定义如下：</p>
<ul>
<li>moduleName: 模块名</li>
<li>dependencies: 依赖列表，每个模块引入后，将会传入到 factory 函数中，默认值为[“require”, “exports”, “module”]</li>
<li>factory: 最后一个参数，定义了模块的具体实现，模块的导出值为函数的返回值或者指定对象</li>
</ul>
<h4 id="简单模块"><a href="#简单模块" class="headerlink" title="简单模块"></a>简单模块</h4><p>若一个模块，只有输出简单的键值对，则只需在define()定义这些键值对就可以</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">define(&#123;</span><br><span class="line">    todos: [</span><br><span class="line">        <span class="string">'read book'</span>,</span><br><span class="line">        <span class="string">'read document'</span>,</span><br><span class="line">        <span class="string">'runnig'</span></span><br><span class="line">    ],</span><br><span class="line">    completed: [</span><br><span class="line">        <span class="string">'breakfast'</span></span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="函数模块"><a href="#函数模块" class="headerlink" title="函数模块"></a>函数模块</h4><p>若一个模块没有依赖，只需要函数来做一些简单的初始化工作，然后输出模块，那么可以使用一个函数来定义模块</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//my/shirt.js now does setup work</span></span><br><span class="line"><span class="comment">//before returning its module definition.</span></span><br><span class="line">define(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//Do setup work here</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        color: <span class="string">"black"</span>,</span><br><span class="line">        size: <span class="string">"unisize"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h4 id="定义带有依赖的模块"><a href="#定义带有依赖的模块" class="headerlink" title="定义带有依赖的模块"></a>定义带有依赖的模块</h4><p>比如，定义一个 <code>todo</code>的模块，依赖 <code>jQuery</code>模块，则模块的定义为</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">define(<span class="string">'todo'</span>, [<span class="string">'jQuery'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">$</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> todos = [];</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">addTodo</span>(<span class="params">item</span>) </span>&#123;</span><br><span class="line">        todo.push(item);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getTodo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> todos;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 模块输出</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        addTodo,</span><br><span class="line">        getTodo</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h4 id="使用require引入模块"><a href="#使用require引入模块" class="headerlink" title="使用require引入模块"></a>使用require引入模块</h4><p>也可以使用 <code>require</code> 引用外部依赖</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params">require, exports, module</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> a = <span class="built_in">require</span>(<span class="string">'a'</span>),</span><br><span class="line">            b = <span class="built_in">require</span>(<span class="string">'b'</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//Return the module value</span></span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;&#125;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用模块"><a href="#使用模块" class="headerlink" title="使用模块"></a>使用模块</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">requrie([<span class="string">'todo'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">todo</span>) </span>&#123;</span><br><span class="line">  todo.addTodo(<span class="string">'read document'</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>


<h2 id="CMD-和-sea-js"><a href="#CMD-和-sea-js" class="headerlink" title="CMD 和 sea.js"></a>CMD 和 sea.js</h2><p><a href="https://github.com/cmdjs/specification/blob/master/draft/module.md" target="_blank" rel="noopener">CMD</a>(Common Module Definition)，而<code>sea.js</code>就是实现 CMD 规范的一个模块加载包。</p>
<h3 id="模块定义"><a href="#模块定义" class="headerlink" title="模块定义"></a>模块定义</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F; 定义一个模块</span><br><span class="line">define(function(require, exports, module) &#123;</span><br><span class="line">  &#x2F;&#x2F; 加载jquery模块</span><br><span class="line">  var $ &#x3D; require(&#39;jquery&#39;);</span><br><span class="line">  &#x2F;&#x2F; 直接使用模块里的方法</span><br><span class="line">  $(&#39;#header&#39;).hide();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>原理可以参考 卢勃 在<a href="https://www.zhihu.com/question/20342350/answer/14828786" target="_blank" rel="noopener">知乎</a>上的回答。原话就是</p>
<pre><code>1. 通过回调函数的Function.toString函数，使用正则表达式来捕捉内部的require字段，找到require(&apos;jquery&apos;)内部依赖的模块jquery

2. 根据配置文件，找到jquery的js文件的实际路径

3. 在dom中插入script标签，载入模块指定的js，绑定加载完成的事件，使得加载完成后将js文件绑定到require模块指定的id（这里就是jquery这个字符串）上

4. 回调函数内部依赖的js全部加载（暂不调用）完后，调用回调函数

5. 当回调函数调用require(&apos;jquery&apos;)，即执行绑定在&apos;jquery&apos;这个id上的js文件，即刻执行，并将返回值传给var b</code></pre><h3 id="与requireJS的区别"><a href="#与requireJS的区别" class="headerlink" title="与requireJS的区别"></a>与requireJS的区别</h3><p><code>sea.js</code> 和 <code>requireJS</code> 都是在执行回调前加载完所有依赖，区别就是<code>requreJS</code> 在加载完依赖后立即执行，而<code>sea.js</code>则是执行回调函数的时候，require 依赖的时候时候才执行对应依赖的代码。</p>
<p>执行代码的时间区别不大，除非是很大的库。</p>
<h2 id="ESM"><a href="#ESM" class="headerlink" title="ESM"></a>ESM</h2><p>ES6 提出了 Javascript 标准的模块规范。详细的ESM模块可以查看 <a href="https://es6.ruanyifeng.com/#docs/module" target="_blank" rel="noopener">阮一峰老师的 ES6 教程</a></p>
<h3 id="模块定义-1"><a href="#模块定义-1" class="headerlink" title="模块定义"></a>模块定义</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var todos &#x3D; [];</span><br><span class="line"></span><br><span class="line">function addTodo(item) &#123;</span><br><span class="line">    todo.push(item);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function getTodo() &#123;</span><br><span class="line">    return todos;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 通过 module.exports 导出模块</span><br><span class="line">export default &#123;</span><br><span class="line">    addTodo,</span><br><span class="line">    getTodo</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="模块的使用"><a href="#模块的使用" class="headerlink" title="模块的使用"></a>模块的使用</h3><p>ESM 使用 <code>import</code> 导入相关的模块</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> todo <span class="keyword">from</span> <span class="string">'./todo'</span>;</span><br><span class="line"></span><br><span class="line">todo.addTodo(<span class="string">'read document'</span>);</span><br></pre></td></tr></table></figure>

<h2 id="UMD"><a href="#UMD" class="headerlink" title="UMD"></a>UMD</h2><p>UMD（Universial Module Definition)，是一种兼容 <code>CommonJS</code>、<code>AMD</code>、<code>CMD</code>规范的一种写法。</p>
<p>UMD的写法如下</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">global, factory</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="built_in">module</span> === <span class="string">'object'</span> &amp;&amp; <span class="keyword">typeof</span> <span class="built_in">module</span>.exports === <span class="string">'object'</span>) &#123;</span><br><span class="line">        <span class="comment">// commonJS</span></span><br><span class="line">        depModule = <span class="built_in">require</span>(<span class="string">'depModule'</span>);</span><br><span class="line">        <span class="built_in">module</span>.exports = factory(depModule);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> define === <span class="string">'function'</span> &amp;&amp; define.amd)  &#123;</span><br><span class="line">        <span class="comment">// amd</span></span><br><span class="line">        define([<span class="string">'depModule'</span>], factory);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> define === <span class="string">'function'</span> &amp;&amp; define.cmd) &#123;</span><br><span class="line">        <span class="comment">// cmd</span></span><br><span class="line">        define(<span class="function"><span class="keyword">function</span>(<span class="params">require, exports, module</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">var</span> depModule = <span class="built_in">require</span>(<span class="string">'depModule'</span>);</span><br><span class="line">            <span class="keyword">return</span> factory(depModule)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// 引入到全局变量中</span></span><br><span class="line">        global.umdModule = factory(global.depModule)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)(<span class="keyword">this</span>, <span class="function"><span class="keyword">function</span>(<span class="params">depModule</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 这里可以使用depModule</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 模块的导出</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        ...</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="ES6-模块与-CommonJS-模块的差异"><a href="#ES6-模块与-CommonJS-模块的差异" class="headerlink" title="ES6 模块与 CommonJS 模块的差异"></a>ES6 模块与 CommonJS 模块的差异</h2><p>参考<a href="https://es6.ruanyifeng.com/#docs/module-loader#ES6-%E6%A8%A1%E5%9D%97%E4%B8%8E-CommonJS-%E6%A8%A1%E5%9D%97%E7%9A%84%E5%B7%AE%E5%BC%82" target="_blank" rel="noopener">阮一峰老师的话</a>，差异主要有两点</p>
<ul>
<li>CommonJS 模块输出的是一个值的拷贝，ES6 模块输出的是值的引用。</li>
<li>CommonJS 模块是运行时加载，ES6 模块是编译时输出接口。</li>
</ul>
<h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><ul>
<li><a href="http://shouce.jb51.net/webpack/amd.html" target="_blank" rel="noopener">AMD 规范</a></li>
<li><a href="http://hexo.wbjiang.cn/sea.js%E7%9A%84%E5%90%8C%E6%AD%A5%E9%AD%94%E6%B3%95.html" target="_blank" rel="noopener">sea.js的同步魔法</a></li>
</ul>
]]></content>
      <tags>
        <tag>front-end</tag>
      </tags>
  </entry>
  <entry>
    <title>react 项目的基本搭建</title>
    <url>/blog/2020/02/29/react-project-note/</url>
    <content><![CDATA[<h1 id="react-项目配置"><a href="#react-项目配置" class="headerlink" title="react 项目配置"></a>react 项目配置</h1><p>自己搭了一套 react 的的后台，下面记录了我一步步搭建的过程，希望对大家有所帮助。</p>
<p>文章主要描述了下面几个部分</p>
<ul>
<li>项目的结构</li>
<li>项目的搭建过程<ul>
<li>webpack 的多环境配置、loader配置、webserver配置等</li>
<li>babel 的基本配置</li>
<li>eslint 的基本配置<a id="more"></a>
<h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">|</span><br><span class="line">|- config               &#x2F;&#x2F; webpack 相关配置</span><br><span class="line">|   |- webpack.common.js    &#x2F;&#x2F; 通用的配置</span><br><span class="line">|   |- webpack.dev.js       &#x2F;&#x2F; 发展的配置 </span><br><span class="line">|   |- webpack.prod.js      &#x2F;&#x2F; 生产的配置</span><br><span class="line">|</span><br><span class="line">|- dist                 &#x2F;&#x2F; 放置打包好的文件</span><br><span class="line">|- public               &#x2F;&#x2F; 放置html模板以及图标等</span><br><span class="line">|- src</span><br><span class="line">|   |- apis             &#x2F;&#x2F; apis 接口文件</span><br><span class="line">|   |   |- brand.js</span><br><span class="line">|   |   |- channel.js</span><br><span class="line">|   |   |- ...</span><br><span class="line">|   |</span><br><span class="line">|   |- assets           &#x2F;&#x2F; 放置通用的资源</span><br><span class="line">|   |   |- images</span><br><span class="line">|   |   |- icons</span><br><span class="line">|   |</span><br><span class="line">|   |- components       &#x2F;&#x2F; 通用的组件</span><br><span class="line">|   |   |- PageLoading</span><br><span class="line">|   |</span><br><span class="line">|   |- config</span><br><span class="line">|   |   |- menu.js      &#x2F;&#x2F; 菜单配置</span><br><span class="line">|   |   |- routes.js    &#x2F;&#x2F; 路由配置</span><br><span class="line">|   |</span><br><span class="line">|   |- layouts          &#x2F;&#x2F; 布局组件</span><br><span class="line">|   |   |- BasicLayout  &#x2F;&#x2F; 基本布局</span><br><span class="line">|   |   |   |- components   &#x2F;&#x2F; 组成布局的组件</span><br><span class="line">|   |   |   |- index.jsx    &#x2F;&#x2F; 布局的主要结构文件</span><br><span class="line">|   |   |   |- index.module.scss    &#x2F;&#x2F; 布局对应的scss</span><br><span class="line">|   |   |-...</span><br><span class="line">|   |</span><br><span class="line">|   |- pages            &#x2F;&#x2F; 页面文件</span><br><span class="line">|   |   |- OrderManage</span><br><span class="line">|   |   |- ...</span><br><span class="line">|   |</span><br><span class="line">|   |- stores</span><br><span class="line">|   |   |- actions</span><br><span class="line">|   |   |   |- index.js &#x2F;&#x2F; 触发 actions 的常量名列表</span><br><span class="line">|   |   |   |- menu.js  &#x2F;&#x2F; 对应的 actions</span><br><span class="line">|   |   |</span><br><span class="line">|   |   |- reducers</span><br><span class="line">|   |   |   |- index.js &#x2F;&#x2F; 合并各个模块的 reducer，输入根的 reducer</span><br><span class="line">|   |   |   |- menu.js  &#x2F;&#x2F; 对应模块的 reducer</span><br><span class="line">|   |   |</span><br><span class="line">|   |   |- index.js     &#x2F;&#x2F; 输出根据 rootReducer 生成 store</span><br><span class="line">|   |</span><br><span class="line">|   |- utils &#x2F;&#x2F; 各种工具</span><br><span class="line">|   |   |- date.js      &#x2F;&#x2F; 日期格式化相关的工具</span><br><span class="line">|   |   |- request.js   &#x2F;&#x2F; 封装好的 axios 组件</span><br><span class="line">|   |</span><br><span class="line">|   |- index.js         &#x2F;&#x2F; 入口文件</span><br><span class="line">|   |- router.jsx       &#x2F;&#x2F; 生成路由组件</span><br><span class="line">|</span><br><span class="line">|- test                 &#x2F;&#x2F; 测试文件</span><br><span class="line">|   |- unit             &#x2F;&#x2F; 单元测试</span><br><span class="line">|</span><br><span class="line">|- .babelrc             &#x2F;&#x2F; babel 相关配置</span><br><span class="line">|- .editourconfig       &#x2F;&#x2F; 编辑器的相关配置，编辑器会根据此格式化文件</span><br><span class="line">|- .eslintrc.js         &#x2F;&#x2F; eslint 的配置文件</span><br><span class="line">|- .gitignore           &#x2F;&#x2F; git 忽略追踪的配置文件</span><br><span class="line">|- jsconfig.josn        &#x2F;&#x2F; js的配置文件，可以让别名 alias 得到识别</span><br><span class="line">|- package.json         &#x2F;&#x2F; 配置文件</span><br><span class="line">|- postcss.config.js    &#x2F;&#x2F; postcss 配置文件</span><br><span class="line">|- README.md            &#x2F;&#x2F; Readme.md 文件</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
<h2 id="项目搭建"><a href="#项目搭建" class="headerlink" title="项目搭建"></a>项目搭建</h2><p>初始化项目</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm init</span><br></pre></td></tr></table></figure>

<p>安装webpack</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install --save-dev webpack</span><br></pre></td></tr></table></figure>
<p>webpack 4+ 需要安装 CLI</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm install --save-dev webpack-cli</span><br></pre></td></tr></table></figure>
<p>创建一个 config 文件夹，专门用于存放 webpack 的配置文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">|- config</span><br><span class="line">    |- webpack.common.js    存放开发和生产环境共用的配置</span><br><span class="line">    |- webpack.dev.js       开发环境的配置</span><br><span class="line">    |- webpack.prod.js      生产环境的配置</span><br></pre></td></tr></table></figure>

<p>这里使用到<code>webpack-merge</code>合并通用配置</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm i webpack-merge -D</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.common.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; CleanWebpackPlugin &#125; = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rootPath = path.resolve(__dirname, <span class="string">'../'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    index: path.resolve(rootPath, <span class="string">'src/index'</span>)    <span class="comment">// 入口文件</span></span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'static/js/[name].[hash:8].bundle.js'</span>,       <span class="comment">// 将文件放置到 static/js目录下，名字格式为[name].[hash:8].bundle.js</span></span><br><span class="line">    chunkFilename: <span class="string">'static/js/[name].[hash:8].bundle.js'</span>,  <span class="comment">// 将 bunndle 文件也放置在 static/js 目录下</span></span><br><span class="line">    path: path.resolve(rootPath, <span class="string">'dist'</span>),         <span class="comment">// 打包文件存放的根目录</span></span><br><span class="line">    publicPath: <span class="string">'/'</span>                               <span class="comment">// 引入文件的根目录</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123; ...</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [ ... ],</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      <span class="string">'@'</span>: path.resolve(rootPath, <span class="string">'src'</span>)                      <span class="comment">// 设置 @ 为 src 的别名</span></span><br><span class="line">    &#125;,</span><br><span class="line">    extensions: [<span class="string">'.js'</span>, <span class="string">'.jsx'</span>, <span class="string">'.json'</span>]                      <span class="comment">// 没有扩展名的时候，尝试的扩展名</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// webpack.dev.js</span></span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">"webpack-merge"</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>);</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">"webpack"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> common = <span class="built_in">require</span>(<span class="string">"./webpack.common"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rootPath = path.resolve(__dirname, <span class="string">"../"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = merge(common, &#123;</span><br><span class="line">  mode: <span class="string">"development"</span>, <span class="comment">// 设置为开发模式，使用 webpack 内置专为开发配置的设置</span></span><br><span class="line">  devtool: <span class="string">"cheap-source-map"</span>,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      ...</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  devServer: &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [ ... ]</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// prod.webpack.js</span></span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">"webpack-merge"</span>);</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">"webpack"</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>);</span><br><span class="line"><span class="keyword">const</span> common = <span class="built_in">require</span>(<span class="string">"./webpack.common"</span>);</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">"mini-css-extract-plugin"</span>);</span><br><span class="line"><span class="keyword">const</span> OptimizeCssAssetsPlugin = <span class="built_in">require</span>(<span class="string">"optimize-css-assets-webpack-plugin"</span>); <span class="comment">// 压缩 css, 好像有没有也可以~</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rootPath = path.resolve(__dirname, <span class="string">"../"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = merge(common, &#123;</span><br><span class="line">  mode: <span class="string">"production"</span>, <span class="comment">// 启动生产模式，使用webpack默认设置的生产模式的设定</span></span><br><span class="line">  devtool: <span class="string">"none"</span>,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [ ... ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [ ... ]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>在<code>package.json</code>中调用对应的配置文件</p>
<figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"scripts"</span>: &#123;</span><br><span class="line">    <span class="attr">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,</span><br><span class="line">    <span class="attr">"build"</span>: <span class="string">"webpack --config ./config/webpack.dev.js"</span>,</span><br><span class="line">    <span class="attr">"dev"</span>: <span class="string">"webpack --config ./config/webpack.prod.js"</span></span><br><span class="line">  &#125;,Ï</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="HtmlWebpackPlugin"><a href="#HtmlWebpackPlugin" class="headerlink" title="HtmlWebpackPlugin"></a>HtmlWebpackPlugin</h4><blockquote>
<p>HtmlWebpackPlugin插件自动生成html文件，引入对应的包文件</p>
</blockquote>
<p>安装</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install --save-dev html-webpack-plugin</span><br></pre></td></tr></table></figure>
<p>在<code>common.js</code>中添加以下配置</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const HtmlWebpackPlugin &#x3D; require(&#39;html-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">const rootPath &#x3D; path.resolve(__dirname, &#39;..&#x2F;&#39;);</span><br><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">        new HtmlWebpackPlugin(&#123;</span><br><span class="line">          &#x2F;&#x2F; 自动生成引入 bundle 文件的 html</span><br><span class="line">          template: path.resolve(rootPath, &#39;public&#x2F;index.html&#39;),  &#x2F;&#x2F; 使用 public 下的 index 文件作为 html 模板</span><br><span class="line">          favicon: path.resolve(rootPath, &#39;public&#x2F;favicon.ico&#39;)   &#x2F;&#x2F; 引入 图标</span><br><span class="line">    &#125;)</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="webpack-dev-server"><a href="#webpack-dev-server" class="headerlink" title="webpack-dev-server"></a>webpack-dev-server</h4><p>安装</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install --save-dev webpack-dev-server</span><br></pre></td></tr></table></figure>
<p>在<code>dev.js</code>配置</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">module.exports &#x3D; &#123;</span><br><span class="line">  devServer: &#123;</span><br><span class="line">  contentBase: path.resolve(rootPath, &quot;dist&quot;), &#x2F;&#x2F; 服务器的根目录</span><br><span class="line">    compress: true,     &#x2F;&#x2F; 启用 gzip 压缩</span><br><span class="line">    overlay: true,      &#x2F;&#x2F; 错误在浮层显示</span><br><span class="line">    open: true,         &#x2F;&#x2F; 服务器开启后，自动在浏览器打开</span><br><span class="line">    hot: true,          &#x2F;&#x2F; 启用热加载</span><br><span class="line">    host: &quot;0.0.0.0&quot;,    &#x2F;&#x2F; 服务启动的ip，可以让在局域网内的用户都可以访问</span><br><span class="line">    port: 9000,         &#x2F;&#x2F; 开启的端口</span><br><span class="line">    proxy: [</span><br><span class="line">      &#x2F;&#x2F; 代理配置</span><br><span class="line">      &#123;</span><br><span class="line">        context: &quot;&#x2F;api&#x2F;geo&#x2F;&quot;,</span><br><span class="line">        target: &quot;http:&#x2F;&#x2F;0.0.0.0:1131&quot;,  &#x2F;&#x2F; 转发的地址</span><br><span class="line">        changeOrigin: true,             &#x2F;&#x2F; 是否改变转发的域名</span><br><span class="line">        secure: false                   &#x2F;&#x2F; 关闭安全的设定</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        context: [</span><br><span class="line">          &quot;&#x2F;api&#x2F;v2&quot;,</span><br><span class="line">          &quot;&#x2F;api&#x2F;orderproduct&quot;,</span><br><span class="line">          &quot;&#x2F;api&#x2F;member&quot;,</span><br><span class="line">          &quot;&#x2F;api&#x2F;user&quot;,</span><br><span class="line">          &quot;&#x2F;api&#x2F;channel&quot;,</span><br><span class="line">          &quot;&#x2F;api&#x2F;store2&quot;,</span><br><span class="line">          &quot;&#x2F;api&#x2F;white&quot;,</span><br><span class="line">          &quot;&#x2F;api&#x2F;taobao&quot;,</span><br><span class="line">          &quot;&#x2F;api&#x2F;tool&quot;,</span><br><span class="line">          &quot;&#x2F;api&#x2F;brand&quot;,</span><br><span class="line">          &quot;&#x2F;api&#x2F;order&quot;</span><br><span class="line">        ],                              </span><br><span class="line">        target: &quot;http:&#x2F;&#x2F;127.0.0.1:9502&quot;     &#x2F;&#x2F; 批量转发，上面的接口都转发到本地的9502接口</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        context: &quot;&#x2F;api&quot;,</span><br><span class="line">        target: &quot;http:&#x2F;&#x2F;127.0.0.1:11299&quot;,   &#x2F;&#x2F; api前缀的转发到11299端口</span><br><span class="line">        changeOrigin: true,                 &#x2F;&#x2F; 是否改变转发的域名</span><br><span class="line">        secure: false                       &#x2F;&#x2F; 关闭安全的设定</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    historyApiFallback: true                &#x2F;&#x2F; 404的时候重定向回 index.html</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>某些路由使用的history模式的路由，需要404时候，重定向回 index.html，则可以开启下面的选项</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">historyApiFallback: true &#x2F;&#x2F; 404的时候重定向回 index.html</span><br></pre></td></tr></table></figure>

<h4 id="clean-webpack-plugin"><a href="#clean-webpack-plugin" class="headerlink" title="clean-webpack-plugin"></a>clean-webpack-plugin</h4><p>安装</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install --save-dev clean-webpack-plugin</span><br></pre></td></tr></table></figure>
<p>在common中配置文件</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const &#123; CleanWebpackPlugin &#125; &#x3D; require(&#39;clean-webpack-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module.exports &#123;</span><br><span class="line">    plugins: [</span><br><span class="line">        new CleanWebpackPlugin() &#x2F;&#x2F; 清除 dist 文件</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="图片的loader"><a href="#图片的loader" class="headerlink" title="图片的loader"></a>图片的loader</h4><p>安装url-loader, url-loader可以将小于一定大小的图片，转换成DataURL格式然后引入，对于大于等于指定大小的图片，将会默认使用 file-loader 将图片引入，所以需要安装file-loader</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">npm i url-loader file-loader -D</span><br></pre></td></tr></table></figure>
<p>loader配置</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line">    module: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">              &#123;</span><br><span class="line">                test: &#x2F;\.(png|jpe?g|gif)$&#x2F;i,</span><br><span class="line">                loader: &#39;url-loader&#39;,</span><br><span class="line">                options: &#123;</span><br><span class="line">                  limit: 10240,                           &#x2F;&#x2F; 小于 10kb 的图片转化为 url 数据引入，否则调用 file-loader 引入文件</span><br><span class="line">                  name: &#39;static&#x2F;img&#x2F;[path][name].[ext]&#39;   &#x2F;&#x2F; 图片放置在 static&#x2F;img 目录下, 生产模式可以使用内容哈希的文件名，来缓存</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h4 id="字体文件的loader"><a href="#字体文件的loader" class="headerlink" title="字体文件的loader"></a>字体文件的loader</h4><p>字体文件loader与图片文件的loader类似,同样需要url-loader以及file-loader</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm i url-loader file-loader -D</span><br></pre></td></tr></table></figure>
<p>option配置</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">...</span><br><span class="line">  &#123;</span><br><span class="line">    test: &#x2F;\.(svg|eot|ttf|woff|woff2)$&#x2F;i,</span><br><span class="line">    loader: &#39;url-loader&#39;,</span><br><span class="line">    options: &#123;</span><br><span class="line">      limit: 4096,                            &#x2F;&#x2F; 与图片loader类似</span><br><span class="line">      name: &#39;static&#x2F;fonts&#x2F;[path][name].[ext]&#39; &#x2F;&#x2F; 字体文件放置在 static&#x2F;fonts 文件下</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<h4 id="css以及scss样式loader的配置"><a href="#css以及scss样式loader的配置" class="headerlink" title="css以及scss样式loader的配置"></a>css以及scss样式loader的配置</h4><p>先安装css的相关loader</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm i style-loader css-loader -D</span><br></pre></td></tr></table></figure>
<p>安装scss的相关loader</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm i node-sass sass-loader --save-dev</span><br></pre></td></tr></table></figure>
<p>为了让自动加上css前缀，需要安装postcss</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install postcss-loader autoprefixer --save-dev</span><br></pre></td></tr></table></figure>
<p>在根目录创建一个 postcss.config.js 配置文件,</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  loader: <span class="string">"postcss-loader"</span>,</span><br><span class="line">  plugins: &#123;</span><br><span class="line">    <span class="string">"postcss-preset-env"</span>: &#123;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>安装<code>postcss-preset-env</code>，默认包含了autoprefixer</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm i -D postcss-preset-env</span><br></pre></td></tr></table></figure>
<p>对于module后缀的启动css模块化</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &#x2F;&#x2F; 对于module。scss或者 module.css后缀的文件，开启 css 模块化，并设定指定生成class的格式</span><br><span class="line">  test: &#x2F;\.module\.s?css&#x2F;,</span><br><span class="line">  use: [</span><br><span class="line">    &#39;style-loader&#39;,</span><br><span class="line">    &#123;</span><br><span class="line">      loader: &#39;css-loader&#39;,</span><br><span class="line">      options: &#123;</span><br><span class="line">        importLoaders: 2,</span><br><span class="line">        modules: &#123;</span><br><span class="line">          mode: &#39;local&#39;,</span><br><span class="line">          localIdentName: &#39;[path][name]__[local]--[hash:base64:5]&#39; </span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#39;postcss-loader&#39;,</span><br><span class="line">    &#39;sass-loader&#39;</span><br><span class="line">  ]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>其余的样式文件关闭css模块化，否则会造成引入的antd样式失效</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F; 除了带有module结尾的scss文件或者css文件，不使用css模块化，否则将会导致antd的样式失效</span><br><span class="line">    test: &#x2F;\.s?css$&#x2F;,</span><br><span class="line">    exclude: &#x2F;\.module\.s?css$&#x2F;,</span><br><span class="line">    use: [</span><br><span class="line">      &#39;style-loader&#39;,</span><br><span class="line">      &#123;</span><br><span class="line">        loader: &#39;css-loader&#39;,</span><br><span class="line">        options: &#123;</span><br><span class="line">          importLoaders: 2</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#39;postcss-loader&#39;,</span><br><span class="line">      &#39;sass-loader&#39;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对于生产环境，若想将css提取出来，需要安装<code>mini-css-extract-plugin</code></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm i mini-css-extract-plugin --save-dev</span><br></pre></td></tr></table></figure>
<p>更改<code>webpack.prod.js</code>,将style-loader换成 css module 即可</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">const MiniCssExtractPlugin &#x3D; require(&#39;mini-css-extract-plugin&#39;);</span><br><span class="line"></span><br><span class="line">module: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">    &#123;</span><br><span class="line">        &#x2F;&#x2F; module.scss 或者 module.css 结尾的文件启动css module，并提取到单独的文件夹</span><br><span class="line">        test: &#x2F;\.module\.s?css&#x2F;,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: MiniCssExtractPlugin.loader &#x2F;&#x2F; 提取到单独的文件</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: &#39;css-loader&#39;,</span><br><span class="line">            options: &#123;</span><br><span class="line">              importLoaders: 2,</span><br><span class="line">              modules: &#123;</span><br><span class="line">                mode: &#39;local&#39;,</span><br><span class="line">                localIdentName: &#39;[hash:base64:8]&#39;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#39;postcss-loader&#39;,</span><br><span class="line">          &#39;sass-loader&#39;</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        &#x2F;&#x2F; 除了module的scss或css文件，都不启动 css module 并且提取到单独的文件</span><br><span class="line">        test: &#x2F;\.s?css$&#x2F;,</span><br><span class="line">        exclude: &#x2F;\.module\.s?css$&#x2F;,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: MiniCssExtractPlugin.loader</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: &#39;css-loader&#39;,</span><br><span class="line">            options: &#123;</span><br><span class="line">              importLoaders: 2</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          &#39;postcss-loader&#39;,</span><br><span class="line">          &#39;sass-loader&#39;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">plugins: [</span><br><span class="line">    new MiniCssExtractPlugin(&#123;</span><br><span class="line">      filename: &#39;static&#x2F;css&#x2F;[name].[hash:8].css&#39;,         &#x2F;&#x2F; 将css文件都提取到 static&#x2F;css 目录下</span><br><span class="line">      chunkFilename: &#39;static&#x2F;css&#x2F;[id].[hash:8].css&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h4 id="babel配置"><a href="#babel配置" class="headerlink" title="babel配置"></a>babel配置</h4><p>react中大多都是使用es6语法编写，为了让es6语法以及react的jsx语法能够正确在浏览器上运行，需要安装babel，</p>
<ul>
<li>@babel-core</li>
<li>@babel/preset-env 将es6语法转换成es5语法</li>
<li>@babel/preset-react 将jsx语法转换为Javascript</li>
<li>@babel/polyfill: ES6 内置方法和函数转化垫片</li>
<li>@babel/plugin-transform-runtime: 避免 polyfill 污染全局变量，减小打包体积<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm i @babel&#x2F;core babel-loader @babel&#x2F;preset-env @babel&#x2F;preset-react --save-dev</span><br></pre></td></tr></table></figure>
在根目录创建<code>.babelrc</code>文件<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;presets&quot;: [&quot;@babel&#x2F;preset-env&quot;, &quot;@babel&#x2F;preset-react&quot;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
若想转换es6新的语法，则需要安装<code>@babel/polyfill</code><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm i @babel&#x2F;polyfill @babel&#x2F;runtime</span><br></pre></td></tr></table></figure>
若想重复利用babel注入的工具代码，可以安装以下插件<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">@babel&#x2F;plugin-transform-runtime</span><br></pre></td></tr></table></figure>
若想要直接在 class 里面声明静态类变量以及直接声明箭头函数的实例方法<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">class Dog &#123;</span><br><span class="line">    &#x2F;&#x2F; 声明静态变量</span><br><span class="line">    static type &#x3D; &#39;animal&#39;;</span><br><span class="line">    </span><br><span class="line">    &#x2F;&#x2F; 箭头函数的实例方法</span><br><span class="line">    bark &#x3D; () &#x3D;&gt; &#123;</span><br><span class="line">        console.log(&#39;Wang Wang ~&#39;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
需要安装<a href="https://www.npmjs.com/package/@babel/plugin-proposal-class-properties" target="_blank" rel="noopener"> @babel/plugin-proposal-class-properties </a>插件<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install --save-dev @babel&#x2F;plugin-proposal-class-properties</span><br></pre></td></tr></table></figure>
babel 整体配置<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;presets&quot;: [&quot;@babel&#x2F;preset-env&quot;, &quot;@babel&#x2F;preset-react&quot;],</span><br><span class="line">  &quot;plugins&quot;: [</span><br><span class="line">    &quot;react-hot-loader&#x2F;babel&quot;,</span><br><span class="line">    &quot;@babel&#x2F;plugin-proposal-class-properties&quot;,</span><br><span class="line">    [&quot;import&quot;, &#123;</span><br><span class="line">      &quot;libraryName&quot;: &quot;antd&quot;,</span><br><span class="line">      &quot;libraryDirectory&quot;: &quot;es&quot;,</span><br><span class="line">      &quot;style&quot;: &quot;css&quot;</span><br><span class="line">    &#125;]</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="eslint配置"><a href="#eslint配置" class="headerlink" title="eslint配置"></a>eslint配置</h4><figure class="highlight javascript"><figcaption><span>.eslintrc.js</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  env: &#123;</span><br><span class="line">    browser: <span class="literal">true</span>,</span><br><span class="line">    es6: <span class="literal">true</span></span><br><span class="line">  &#125;,</span><br><span class="line">  extends: [<span class="string">'eslint:recommended'</span>, <span class="string">'plugin:react/recommended'</span>],</span><br><span class="line">  globals: &#123;</span><br><span class="line">    Atomics: <span class="string">'readonly'</span>,</span><br><span class="line">    SharedArrayBuffer: <span class="string">'readonly'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  parser: <span class="string">'babel-eslint'</span>,</span><br><span class="line">  parserOptions: &#123;</span><br><span class="line">    ecmaFeatures: &#123;</span><br><span class="line">      jsx: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    ecmaVersion: <span class="number">2018</span>,</span><br><span class="line">    sourceType: <span class="string">'module'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [<span class="string">'react'</span>],</span><br><span class="line">  rules: &#123;</span><br><span class="line">    <span class="string">'react/jsx-filename-extension'</span>: [<span class="string">'warn'</span>, &#123; <span class="attr">extensions</span>: [<span class="string">'.js'</span>, <span class="string">'.jsx'</span>] &#125;],</span><br><span class="line">    <span class="string">'react/prop-types'</span>: [<span class="string">'error'</span>, &#123; <span class="attr">skipUndeclared</span>: <span class="literal">true</span> &#125;],</span><br><span class="line">    <span class="string">'no-unused-vars'</span>: [<span class="string">'warn'</span>]</span><br><span class="line">  &#125;,</span><br><span class="line">  settings: &#123;</span><br><span class="line">    <span class="string">'import/resolver'</span>: &#123;</span><br><span class="line">      alias: &#123;</span><br><span class="line">        map: [[<span class="string">'@'</span>, <span class="string">'./src'</span>]],</span><br><span class="line">        extensions: [<span class="string">'.js'</span>, <span class="string">'.jsx'</span>, <span class="string">'.json'</span>]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="整体webpack的配置"><a href="#整体webpack的配置" class="headerlink" title="整体webpack的配置"></a>整体webpack的配置</h4><p>项目 webpack 文件如下：</p>
<figure class="highlight js"><figcaption><span>webpack.common.js</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="comment">// webpack.commmon.js</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> &#123; CleanWebpackPlugin &#125; = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rootPath = path.resolve(__dirname, <span class="string">'../'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    index: path.resolve(rootPath, <span class="string">'src/index'</span>)    <span class="comment">// 入口文件</span></span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'static/js/[name].[hash:8].bundle.js'</span>,       <span class="comment">// 将文件放置到 static/js目录下，名字格式为[name].[hash:8].bundle.js</span></span><br><span class="line">    chunkFilename: <span class="string">'static/js/[name].[hash:8].bundle.js'</span>,  <span class="comment">// 将 bunndle 文件也放置在 static/js 目录下</span></span><br><span class="line">    path: path.resolve(rootPath, <span class="string">'dist'</span>),         <span class="comment">// 打包文件存放的根目录</span></span><br><span class="line">    publicPath: <span class="string">'/'</span>                               <span class="comment">// 引入文件的根目录</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.jsx?$/</span>,                          <span class="comment">// js, jsx 文件使用的 loader</span></span><br><span class="line">        use: [<span class="string">'babel-loader'</span>, <span class="string">'eslint-loader'</span>],</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>                   <span class="comment">// 不转化 node_modules 下的文件</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      <span class="comment">// 自动生成引入 bundle 文件的 html</span></span><br><span class="line">      template: path.resolve(rootPath, <span class="string">'public/index.html'</span>),  <span class="comment">// 使用 public 下的 index 文件作为 html 模板</span></span><br><span class="line">      favicon: path.resolve(rootPath, <span class="string">'public/favicon.ico'</span>)   <span class="comment">// 引入 图标</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="keyword">new</span> CleanWebpackPlugin() <span class="comment">// 清除 dist 文件夹</span></span><br><span class="line">  ],</span><br><span class="line">  resolve: &#123;</span><br><span class="line">    alias: &#123;</span><br><span class="line">      <span class="string">'@'</span>: path.resolve(rootPath, <span class="string">'src'</span>)                      <span class="comment">// 设置 @ 为 src 的别名</span></span><br><span class="line">    &#125;,</span><br><span class="line">    extensions: [<span class="string">'.js'</span>, <span class="string">'.jsx'</span>, <span class="string">'.json'</span>]                      <span class="comment">// 没有扩展名的时候，尝试的扩展名</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><figcaption><span>webpack.dev.js</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">"webpack-merge"</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>);</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">"webpack"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> common = <span class="built_in">require</span>(<span class="string">"./webpack.common"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rootPath = path.resolve(__dirname, <span class="string">"../"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = merge(common, &#123;</span><br><span class="line">  mode: <span class="string">"development"</span>, <span class="comment">// 设置为开发模式，使用 webpack 内置专为开发配置的设置</span></span><br><span class="line">  devtool: <span class="string">"cheap-source-map"</span>,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// 对于module。scss或者 module.css后缀的文件，开启 css 模块化，并设定指定生成class的格式</span></span><br><span class="line">        test: <span class="regexp">/\.module\.s?css/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          <span class="string">"style-loader"</span>,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">"css-loader"</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              importLoaders: <span class="number">2</span>,</span><br><span class="line">              modules: &#123;</span><br><span class="line">                mode: <span class="string">"local"</span>,</span><br><span class="line">                localIdentName: <span class="string">"[local]--[hash:base64:5]"</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="string">"postcss-loader"</span>,</span><br><span class="line">          <span class="string">"sass-loader"</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// 除了带有module结尾的scss文件或者css文件，不使用css模块化，否则将会导致antd的样式失效</span></span><br><span class="line">        test: <span class="regexp">/\.s?css$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/\.module\.s?css$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          <span class="string">"style-loader"</span>,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">"css-loader"</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              importLoaders: <span class="number">2</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="string">"postcss-loader"</span>,</span><br><span class="line">          <span class="string">"sass-loader"</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(png|jpe?g|gif)$/i</span>,</span><br><span class="line">        loader: <span class="string">"url-loader"</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          limit: <span class="number">4096</span>, <span class="comment">// 小于 10kb 的图片转化为 url 数据引入，否则调用 file-loader 引入文件</span></span><br><span class="line">          name: <span class="string">"static/img/[path][name].[ext]"</span> <span class="comment">// 图片放置在 static/img 目录下</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        test: <span class="regexp">/\.(svg|eot|ttf|woff|woff2)$/i</span>,</span><br><span class="line">        loader: <span class="string">"url-loader"</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          limit: <span class="number">4096</span>, <span class="comment">// 与图片loader类似</span></span><br><span class="line">          name: <span class="string">"static/fonts/[path][name].[ext]"</span> <span class="comment">// 字体文件放置在 static/fonts 文件下</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  devServer: &#123;</span><br><span class="line">    contentBase: path.resolve(rootPath, <span class="string">"dist"</span>), <span class="comment">// 服务器的根目录</span></span><br><span class="line">    compress: <span class="literal">true</span>,     <span class="comment">// 启用 gzip 压缩</span></span><br><span class="line">    overlay: <span class="literal">true</span>,      <span class="comment">// 错误在浮层显示</span></span><br><span class="line">    open: <span class="literal">true</span>,         <span class="comment">// 服务器开启后，自动在浏览器打开</span></span><br><span class="line">    hot: <span class="literal">true</span>,          <span class="comment">// 启用热加载</span></span><br><span class="line">    host: <span class="string">"0.0.0.0"</span>,    <span class="comment">// 服务启动的ip，可以让在局域网内的用户都可以访问</span></span><br><span class="line">    port: <span class="number">9000</span>,         <span class="comment">// 开启的端口</span></span><br><span class="line">    proxy: [</span><br><span class="line">      <span class="comment">// 代理配置</span></span><br><span class="line">      &#123;</span><br><span class="line">        context: <span class="string">"/api/geo/"</span>,</span><br><span class="line">        target: <span class="string">"http://0.0.0.0:1131"</span>,  <span class="comment">// 转发的地址</span></span><br><span class="line">        changeOrigin: <span class="literal">true</span>,             <span class="comment">// 是否改变转发的域名</span></span><br><span class="line">        secure: <span class="literal">false</span>                   <span class="comment">// 关闭安全的设定</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        context: [</span><br><span class="line">          <span class="string">"/api/v2"</span>,</span><br><span class="line">          <span class="string">"/api/orderproduct"</span>,</span><br><span class="line">          <span class="string">"/api/member"</span>,</span><br><span class="line">          <span class="string">"/api/user"</span>,</span><br><span class="line">          <span class="string">"/api/channel"</span>,</span><br><span class="line">          <span class="string">"/api/store2"</span>,</span><br><span class="line">          <span class="string">"/api/white"</span>,</span><br><span class="line">          <span class="string">"/api/taobao"</span>,</span><br><span class="line">          <span class="string">"/api/tool"</span>,</span><br><span class="line">          <span class="string">"/api/brand"</span>,</span><br><span class="line">          <span class="string">"/api/order"</span></span><br><span class="line">        ],                              </span><br><span class="line">        target: <span class="string">"http://127.0.0.1:9502"</span>     <span class="comment">// 批量转发，上面的接口都转发到本地的9502接口</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        context: <span class="string">"/api"</span>,</span><br><span class="line">        target: <span class="string">"http://127.0.0.1:11299"</span>,   <span class="comment">// api前缀的转发到11299端口</span></span><br><span class="line">        changeOrigin: <span class="literal">true</span>,                 <span class="comment">// 是否改变转发的域名</span></span><br><span class="line">        secure: <span class="literal">false</span>                       <span class="comment">// 关闭安全的设定</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    historyApiFallback: <span class="literal">true</span>                <span class="comment">// 404的时候重定向回 index.html</span></span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.NamedModulesPlugin(),</span><br><span class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin(),</span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">      <span class="string">"process.env.NODE_ENV"</span>: <span class="built_in">JSON</span>.stringify(<span class="string">"development"</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><figcaption><span>webpack.prod.js</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">"webpack-merge"</span>);</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">"webpack"</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>);</span><br><span class="line"><span class="keyword">const</span> common = <span class="built_in">require</span>(<span class="string">"./webpack.common"</span>);</span><br><span class="line"><span class="keyword">const</span> MiniCssExtractPlugin = <span class="built_in">require</span>(<span class="string">"mini-css-extract-plugin"</span>);</span><br><span class="line"><span class="keyword">const</span> OptimizeCssAssetsPlugin = <span class="built_in">require</span>(<span class="string">"optimize-css-assets-webpack-plugin"</span>); <span class="comment">// 压缩 css, 好像有没有也可以~</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> rootPath = path.resolve(__dirname, <span class="string">"../"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = merge(common, &#123;</span><br><span class="line">  mode: <span class="string">"production"</span>, <span class="comment">// 启动生产模式，使用webpack默认设置的生产模式的设定</span></span><br><span class="line">  devtool: <span class="string">"none"</span>,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// module.scss 或者 module.css 结尾的文件启动css module，并提取到单独的文件夹</span></span><br><span class="line">        test: <span class="regexp">/\.module\.s?css/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: MiniCssExtractPlugin.loader <span class="comment">// 提取到单独的文件</span></span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">"css-loader"</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              importLoaders: <span class="number">2</span>,</span><br><span class="line">              modules: &#123;</span><br><span class="line">                mode: <span class="string">"local"</span>,</span><br><span class="line">                localIdentName: <span class="string">"[hash:base64:8]"</span></span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="string">"postcss-loader"</span>,</span><br><span class="line">          <span class="string">"sass-loader"</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// 除了module的scss或css文件，都不启动 css module 并且提取到单独的文件</span></span><br><span class="line">        test: <span class="regexp">/\.s?css$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/\.module\.s?css$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          &#123;</span><br><span class="line">            loader: MiniCssExtractPlugin.loader</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">"css-loader"</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              importLoaders: <span class="number">2</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;,</span><br><span class="line">          <span class="string">"postcss-loader"</span>,</span><br><span class="line">          <span class="string">"sass-loader"</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// 图片的loader，小于10Kb就使用base64编码,否则则调用file-loader引入文件，文件名使用由内容哈希组成的文件</span></span><br><span class="line">        test: <span class="regexp">/\.(png|jpe?g|gif)$/i</span>,</span><br><span class="line">        loader: <span class="string">"url-loader"</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          limit: <span class="number">4096</span>,</span><br><span class="line">          name: <span class="string">"static/img/[hash:16].[ext]"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">// 字体文件loader，小于4kb的字体使用base64格式引入，否则使用file-loader引入，字体文件名为内容哈希组成的文件</span></span><br><span class="line">        test: <span class="regexp">/\.(svg|eot|ttf|woff|woff2)$/i</span>,</span><br><span class="line">        loader: <span class="string">"url-loader"</span>,</span><br><span class="line">        options: &#123;</span><br><span class="line">          limit: <span class="number">4096</span>,</span><br><span class="line">          name: <span class="string">"static/fonts/[hash:16].[ext]"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> webpack.DefinePlugin(&#123;</span><br><span class="line">      <span class="string">"process.env.NODE_ENV"</span>: <span class="built_in">JSON</span>.stringify(<span class="string">"production"</span>) <span class="comment">// 将文件中的process.env.NODE_ENV 设置为 production，以优化某些库中的代码</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// 提取 css 到单独的文件</span></span><br><span class="line">    <span class="keyword">new</span> MiniCssExtractPlugin(&#123;</span><br><span class="line">      filename: <span class="string">"static/css/[name].[hash:8].css"</span>, <span class="comment">// 将css文件都提取到 static/css 目录下</span></span><br><span class="line">      chunkFilename: <span class="string">"static/css/[id].[hash:8].css"</span></span><br><span class="line">    &#125;),</span><br><span class="line">    <span class="comment">// 压缩 css</span></span><br><span class="line">    <span class="keyword">new</span> OptimizeCssAssetsPlugin(&#123;</span><br><span class="line">      assetNameRegExp: <span class="regexp">/\.css$/g</span>,</span><br><span class="line">      cssProcessor: <span class="built_in">require</span>(<span class="string">"cssnano"</span>), <span class="comment">//用于优化\最小化 CSS 的 CSS处理器，默认为 cssnano</span></span><br><span class="line">      cssProcessorOptions: &#123; <span class="attr">safe</span>: <span class="literal">true</span>, <span class="attr">discardComments</span>: &#123; <span class="attr">removeAll</span>: <span class="literal">true</span> &#125; &#125;, <span class="comment">//传递给 cssProcessor 的选项，默认为&#123;&#125;</span></span><br><span class="line">      canPrint: <span class="literal">true</span> <span class="comment">//布尔值，指示插件是否可以将消息打印到控制台，默认为 true</span></span><br><span class="line">    &#125;)</span><br><span class="line">  ]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>在<code>webpack.common.js</code>配置输入和输出</p>
<figure class="highlight javascript"><figcaption><span>webpack.common.js</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> rootPath = path.resolve(_dirname, <span class="string">'../'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: &#123;</span><br><span class="line">    index: path.resolve(rootPath, <span class="string">'src/index'</span>)    <span class="comment">// 入口文件</span></span><br><span class="line">  &#125;,</span><br><span class="line">  output: &#123;</span><br><span class="line">    filename: <span class="string">'static/js/[name].bundle.js'</span>,       <span class="comment">// 将文件放置到 static/js目录下，名字格式为[name].bundle.js</span></span><br><span class="line">    chunkFilename: <span class="string">'static/js/[name].bundle.js'</span>,  <span class="comment">// 将 bunndle 文件也放置在 static/js 目录下</span></span><br><span class="line">    path: path.resolve(rootPath, <span class="string">'dist'</span>),         <span class="comment">// 打包文件存放的根目录</span></span><br><span class="line">    publicPath: <span class="string">'/'</span>                               <span class="comment">// 引入文件的根目录</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <tags>
        <tag>react</tag>
        <tag>webpack</tag>
      </tags>
  </entry>
</search>
